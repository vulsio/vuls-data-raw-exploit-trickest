{
	"id": "CVE-2023-36812",
	"tags": [
		{
			"label": "Product",
			"message": "opentsdb"
		},
		{
			"label": "Version",
			"message": "= < 2.4.2 "
		},
		{
			"label": "Vulnerability",
			"message": "CWE-74: Improper Neutralization of Special Elements in Output Used by a Downstream Component ('Injection')"
		}
	],
	"description": " OpenTSDB is a open source, distributed, scalable Time Series Database (TSDB). OpenTSDB is vulnerable to Remote Code Execution vulnerability by writing user-controlled input to Gnuplot configuration file and running Gnuplot with the generated configuration. This issue has been patched in  commit `07c4641471c` and further refined in commit `fa88d3e4b`. These patches are available in the `2.4.2` release. Users are advised to upgrade. User unable to upgrade may disable Gunuplot via the config option`tsd.core.enable_ui = true` and remove the shell files `mygnuplot.bat` and `mygnuplot.sh`.",
	"poc": {
		"references": [
			"http://packetstormsecurity.com/files/174570/OpenTSDB-2.4.1-Unauthenticated-Command-Injection.html",
			"https://github.com/OpenTSDB/opentsdb/commit/07c4641471c6f5c2ab5aab615969e97211eb50d9"
		],
		"githubs": [
			"https://github.com/ErikWynter/opentsdb_key_cmd_injection",
			"https://github.com/nomi-sec/PoC-in-GitHub"
		]
	}
}
