{
  "id": "CVE-2022-24112",
  "tags": [
    {
      "label": "Product",
      "message": "Apache APISIX"
    },
    {
      "label": "Version",
      "message": "Apache APISIX 2.12< 2.12.1 "
    },
    {
      "label": "Vulnerability",
      "message": "CWE-290 Authentication Bypass by Spoofing"
    }
  ],
  "description": " An attacker can abuse the batch-requests plugin to send requests to bypass the IP restriction of Admin API. A default configuration of Apache APISIX (with default API key) is vulnerable to remote code execution. When the admin key was changed or the port of Admin API was changed to a port different from the data panel, the impact is lower. But there is still a risk to bypass the IP restriction of Apache APISIX's data panel. There is a check in the batch-requests plugin which overrides the client IP with its real remote IP. But due to a bug in the code, this check can be bypassed.",
  "poc": {
    "references": [
      "http://packetstormsecurity.com/files/166228/Apache-APISIX-Remote-Code-Execution.html",
      "http://packetstormsecurity.com/files/166328/Apache-APISIX-2.12.1-Remote-Code-Execution.html"
    ],
    "githubs": [
      "https://github.com/34zY/APT-Backpack",
      "https://github.com/ARPSyndicate/cvemon",
      "https://github.com/ARPSyndicate/kenzer-templates",
      "https://github.com/Acczdy/CVE-2022-24112_POC",
      "https://github.com/Awrrays/FrameVul",
      "https://github.com/Axx8/CVE-2022-24112",
      "https://github.com/Greetdawn/Apache-APISIX-dashboard-RCE",
      "https://github.com/Loginsoft-Research/Linux-Exploit-Detection",
      "https://github.com/M4xSec/Apache-APISIX-CVE-2022-24112",
      "https://github.com/Mah1ndra/CVE-2022-24112",
      "https://github.com/Mah1ndra/CVE-2022-244112",
      "https://github.com/Mr-xn/CVE-2022-24112",
      "https://github.com/SYRTI/POC_to_review",
      "https://github.com/Udyz/CVE-2022-24112",
      "https://github.com/WhooAmii/POC_to_review",
      "https://github.com/bigblackhat/oFx",
      "https://github.com/binganao/vulns-2022",
      "https://github.com/hktalent/TOP",
      "https://github.com/hktalent/bug-bounty",
      "https://github.com/kavishkagihan/CVE-2022-24112-POC",
      "https://github.com/manas3c/CVE-POC",
      "https://github.com/nomi-sec/PoC-in-GitHub",
      "https://github.com/shakeman8/CVE-2022-24112",
      "https://github.com/soosmile/POC",
      "https://github.com/superlink996/chunqiuyunjingbachang",
      "https://github.com/trhacknon/Pocingit",
      "https://github.com/twseptian/cve-2022-24112",
      "https://github.com/wshepherd0010/CVE-2022-24112-Lab"
    ]
  }
}
